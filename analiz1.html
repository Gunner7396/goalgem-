<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>V50.9 FINAL MATRIX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }
        .glass { background: #1c1c1e; border: 1px solid rgba(255,255,255,0.1); border-radius: 14px; }
        .in-box { background: #2c2c2e; border: none; border-radius: 10px; padding: 12px; color: #fff; font-weight: 700; text-align: center; width: 100%; font-size: 14px; outline: none; border: 1px solid transparent; transition: 0.2s; }
        .in-box:focus { border-color: #30d158; background: #333; }
        .btn-lig { padding: 8px 12px; border-radius: 10px; font-size: 10px; font-weight: 900; background: #1c1c1e; color: #555; border: 1px solid #2c2c2e; transition: 0.2s; flex-shrink: 0; }
        .btn-lig.active { background: #30d158; color: #000; border-color: #30d158; transform: scale(1.05); }
        .mini-card { background: #1c1c1e; border-radius: 14px; padding: 16px; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 12px; }
        .badge-secure { background: #30d158; color: #000; padding: 2px 8px; border-radius: 4px; font-size: 10px; font-weight: 900; box-shadow: 0 0 10px rgba(48,209,88,0.4); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="p-4 pb-24">

    <div class="flex justify-between items-center mb-6 px-1">
        <div>
            <h1 class="text-2xl font-black italic tracking-tighter uppercase">V50<span class="text-green-500">.9</span></h1>
            <p class="text-[9px] font-black text-gray-500 uppercase tracking-widest">Confidence System Active</p>
        </div>
        <div class="flex gap-2">
            <button onclick="toggleArchive()" class="p-2.5 glass text-[10px] font-black text-blue-400">üìÇ</button>
            <button onclick="clrAll()" class="p-2.5 glass text-[10px] font-black text-red-500">üóëÔ∏è</button>
        </div>
    </div>

    <div class="flex gap-2 overflow-x-auto no-scrollbar mb-6 pb-2">
        <button onclick="sL('PL')" id="l-PL" class="btn-lig active">PREMIER LIG</button>
        <button onclick="sL('LL')" id="l-LL" class="btn-lig">LA LIGA</button>
        <button onclick="sL('SA')" id="l-SA" class="btn-lig">SERIE A</button>
        <button onclick="sL('BL')" id="l-BL" class="btn-lig">BUNDESLIGA</button>
        <button onclick="sL('L1')" id="l-L1" class="btn-lig">LIGUE 1</button>
    </div>

    <div class="glass p-5 mb-8 shadow-2xl">
        <div class="grid grid-cols-2 gap-4 mb-5">
            <input id="hN" placeholder="EV SAHƒ∞Bƒ∞" class="bg-transparent border-b border-gray-800 pb-2 text-[11px] font-black uppercase outline-none focus:border-green-500 transition-all">
            <input id="aN" placeholder="DEPLASMAN" class="bg-transparent border-b border-gray-800 pb-2 text-[11px] font-black uppercase text-right outline-none focus:border-green-500 transition-all">
        </div>
        <div class="space-y-3">
            <div class="grid grid-cols-2 gap-3">
                <input type="number" step="0.001" inputmode="decimal" id="h_xg" class="in-box" placeholder="npxG/Sh">
                <input type="number" step="0.001" inputmode="decimal" id="a_xg" class="in-box" placeholder="npxG/Sh">
            </div>
            <div class="grid grid-cols-2 gap-3">
                <input type="number" step="0.1" inputmode="decimal" id="h_ppa" class="in-box" placeholder="PPA">
                <input type="number" step="0.1" inputmode="decimal" id="a_ppa" class="in-box" placeholder="PPA">
            </div>
            <div class="grid grid-cols-2 gap-3">
                <input type="number" step="0.1" inputmode="decimal" id="h_sca" class="in-box" placeholder="SCA">
                <input type="number" step="0.1" inputmode="decimal" id="a_sca" class="in-box" placeholder="SCA">
            </div>
            <div class="grid grid-cols-2 gap-3">
                <input type="number" step="0.1" inputmode="decimal" id="h_pr" class="in-box" placeholder="PrgR">
                <input type="number" step="0.1" inputmode="decimal" id="a_pr" class="in-box" placeholder="PrgR">
            </div>
        </div>
        <button onclick="run()" class="w-full bg-[#30d158] text-black font-black p-4 rounded-xl mt-6 text-[12px] uppercase tracking-widest active:scale-95 transition shadow-lg shadow-green-500/20">VAADƒ∞ ANALƒ∞Z ET</button>
    </div>

    <div id="latestCard"></div>
    <div id="archiveContainer" class="hidden mt-4 pt-6 border-t border-dashed border-gray-800">
        <div id="arcList" class="flex flex-col gap-4"></div>
    </div>

    <script>
        const B = { PL:[.11,22,48,95], LL:[.09,16,38,75], SA:[.09,17,38,75], BL:[.13,24,50,105], L1:[.1,18,42,85] };
        let cL = 'PL';

        function sL(l){ cL=l; document.querySelectorAll('.btn-lig').forEach(b=>b.classList.remove('active')); document.getElementById('l-'+l).classList.add('active'); }
        function toggleArchive() { document.getElementById('archiveContainer').classList.toggle('hidden'); }

        function run() {
            const ids = ["h_xg","a_xg","h_ppa","a_ppa","h_sca","a_sca","h_pr","a_pr"];
            if (ids.some(id => document.getElementById(id).value.trim() === "")) { alert("T√ºm kutularƒ± doldur!"); return; }

            const n = ids.map(id => Number(document.getElementById(id).value));
            // Power calculation based on weights
            const power = ((n[0]+n[1])/2/B[cL][0])*0.4 + ((n[2]+n[3])/B[cL][1])*0.3 + ((n[4]+n[5])/B[cL][2])*0.2 + ((n[6]+n[7])/B[cL][3])*0.1;

            // Confidence Points
            const t1 = Math.round(Math.max(0, 100 - Math.abs(power - 0.45) * 160));
            const t2 = Math.round(Math.max(0, 100 - Math.abs(power - 0.80) * 160));
            const t3 = Math.round(Math.max(0, 100 - Math.abs(power - 1.25) * 160));

            const item = { hN: document.getElementById('hN').value||"EV", aN: document.getElementById('aN').value||"DEP", conf: [t1, t2, t3], id: Date.now(), league: cL, sk: "" };
            let data = JSON.parse(localStorage.getItem('v50_db') || '[]');
            data.push(item);
            localStorage.setItem('v50_db', JSON.stringify(data));
            
            ids.forEach(id => document.getElementById(id).value = "");
            document.getElementById('hN').value = ""; document.getElementById('aN').value = "";
            render();
            window.scrollTo({ top: document.getElementById('latestCard').offsetTop - 20, behavior: 'smooth' });
        }

        function render() {
            const data = JSON.parse(localStorage.getItem('v50_db') || '[]');
            const arcList = document.getElementById('arcList');
            const latest = document.getElementById('latestCard');
            arcList.innerHTML = ""; latest.innerHTML = "";
            
            data.forEach((i, idx) => {
                const cardHTML = `<div class="mini-card relative border border-white/5">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-[9px] font-black bg-white/10 px-2.5 py-1 rounded text-gray-400 uppercase tracking-widest">${i.league}</span>
                        <input onchange="upSk('${i.id}',this.value)" placeholder="SKOR" class="bg-transparent text-[12px] font-black text-right w-16 text-green-500 outline-none border-b border-white/5" value="${i.sk}">
                    </div>
                    <div class="text-[11px] font-bold text-gray-400 uppercase tracking-tighter mb-5">${i.hN} - ${i.aN}</div>
                    
                    <div class="space-y-5">
                        ${renderConfRow("T1 VAADƒ∞ (0-1 GOL)", i.conf[0], "#30d158")}
                        ${renderConfRow("T2 VAADƒ∞ (TAM 2 GOL)", i.conf[1], "#007aff")}
                        ${renderConfRow("T3 VAADƒ∞ (TAM 3 GOL)", i.conf[2], "#ff3b30")}
                    </div>
                    <button onclick="rm('${i.id}')" class="absolute -top-1 -right-1 text-white/10 p-2 text-xs">√ó</button>
                </div>`;
                if(idx === data.length - 1) latest.innerHTML = `<h3 class="text-[10px] font-black text-green-500 mb-3 uppercase tracking-widest flex items-center gap-2">üü¢ ANALƒ∞Z TAMAMLANDI</h3>` + cardHTML;
                const div = document.createElement('div'); div.innerHTML = cardHTML; arcList.prepend(div);
            });
        }

        function renderConfRow(label, val, color) {
            const isSecure = val >= 80;
            return `
            <div class="flex items-center justify-between">
                <div class="flex flex-col">
                    <span class="text-[10px] font-black ${isSecure ? '' : 'text-gray-600'}" style="color:${isSecure ? color : ''}">${label}</span>
                    <span class="text-[8px] text-gray-600 uppercase italic">Uyum Testi</span>
                </div>
                <div class="flex items-center gap-3">
                    ${isSecure ? `<span class="badge-secure" style="background:${color}">SECURE</span>` : ''}
                    <span class="text-xl font-black ${isSecure ? '' : 'text-gray-900'}" style="color:${isSecure ? color : ''}">%${val}</span>
                </div>
            </div>`;
        }

        function upSk(id, v) { let data = JSON.parse(localStorage.getItem('v50_db') || '[]'); data = data.map(i => i.id == id ? {...i, sk: v} : i); localStorage.setItem('v50_db', JSON.stringify(data)); }
        function rm(id) { if(confirm("Analiz silinsin mi?")) { let data = JSON.parse(localStorage.getItem('v50_db') || '[]'); data = data.filter(i => i.id != id); localStorage.setItem('v50_db', JSON.stringify(data)); render(); } }
        function clrAll() { if(confirm("T√ºm ar≈üiv silinecek?")) { localStorage.removeItem('v50_db'); render(); } }
        window.onload = render;
    </script>
</body>
</html>

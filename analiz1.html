<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FUEL V51.1 MOBI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #09090b; color: #fafafa; font-family: -apple-system, system-ui, sans-serif; -webkit-tap-highlight-color: transparent; }
        .glass { background: #18181b; border: 1px solid #27272a; border-radius: 16px; }
        .in-box { background: #27272a; border: 1px solid transparent; border-radius: 10px; padding: 12px 8px; color: #fff; font-weight: 800; text-align: center; width: 100%; font-size: 14px; outline: none; transition: 0.2s; }
        .in-box:focus { border-color: #22c55e; background: #3f3f46; }
        .btn-lig { padding: 10px; border-radius: 12px; font-size: 11px; font-weight: 800; background: #18181b; color: #71717a; border: 1px solid #27272a; flex: 1; text-align: center; transition: 0.2s; }
        .btn-lig.active { background: #22c55e; color: #000; border-color: #22c55e; transform: scale(1.02); }
        .mini-card { background: #18181b; border-radius: 16px; padding: 14px; border: 1px solid #27272a; margin-bottom: 10px; }
        .win-border { border-color: #22c55e !important; box-shadow: 0 0 20px rgba(34,197,94,0.1); }
        .loss-border { border-color: #ef4444 !important; }
        .metric-label { font-size: 9px; font-weight: 900; color: #52525b; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px; display: block; text-align: center; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="p-4 pb-28">

    <div class="flex justify-between items-center mb-6">
        <div>
            <h1 class="text-2xl font-black italic tracking-tighter uppercase leading-none text-white">FUEL <span class="text-green-500">MOBI</span></h1>
            <div class="flex gap-2 mt-1">
                <span class="text-[10px] font-bold text-zinc-500 uppercase">WinRate: <span id="wr" class="text-green-500 font-black">0%</span></span>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="toggleArchive()" class="w-10 h-10 glass flex items-center justify-center text-blue-400">üìÅ</button>
            <button onclick="clrAll()" class="w-10 h-10 glass flex items-center justify-center text-red-500">üóëÔ∏è</button>
        </div>
    </div>

    <div class="flex gap-2 mb-6 py-1 overflow-x-auto no-scrollbar">
        <button onclick="sL('PL')" id="l-PL" class="btn-lig active">PL</button>
        <button onclick="sL('LL')" id="l-LL" class="btn-lig">LL</button>
        <button onclick="sL('SA')" id="l-SA" class="btn-lig">SA</button>
        <button onclick="sL('BL')" id="l-BL" class="btn-lig">BL</button>
        <button onclick="sL('L1')" id="l-L1" class="btn-lig">L1</button>
    </div>

    <div class="glass p-5 shadow-2xl mb-8">
        <div class="grid grid-cols-2 gap-4 mb-6">
            <input id="hN" placeholder="EV SAHƒ∞Bƒ∞" class="bg-transparent border-b-2 border-zinc-800 py-1 text-sm font-black uppercase outline-none focus:border-green-500">
            <input id="aN" placeholder="DEPLASMAN" class="bg-transparent border-b-2 border-zinc-800 py-1 text-sm font-black uppercase text-right outline-none focus:border-green-500">
        </div>

        <div class="space-y-4">
            <div>
                <span class="metric-label">npxG / SHOT</span>
                <div class="grid grid-cols-2 gap-2">
                    <input type="number" step="0.001" inputmode="decimal" id="h_xg" class="in-box" placeholder="0.000">
                    <input type="number" step="0.001" inputmode="decimal" id="a_xg" class="in-box" placeholder="0.000">
                </div>
            </div>
            <div>
                <span class="metric-label">PPA (Pass into Pen)</span>
                <div class="grid grid-cols-2 gap-2">
                    <input type="number" inputmode="decimal" id="h_ppa" class="in-box" placeholder="0">
                    <input type="number" inputmode="decimal" id="a_ppa" class="in-box" placeholder="0">
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <span class="metric-label">PrgR</span>
                    <div class="grid grid-cols-2 gap-1">
                        <input type="number" inputmode="decimal" id="h_pr" class="in-box" placeholder="0">
                        <input type="number" inputmode="decimal" id="a_pr" class="in-box" placeholder="0">
                    </div>
                </div>
                <div>
                    <span class="metric-label">SCA</span>
                    <div class="grid grid-cols-2 gap-1">
                        <input type="number" inputmode="decimal" id="h_sca" class="in-box" placeholder="0">
                        <input type="number" inputmode="decimal" id="a_sca" class="in-box" placeholder="0">
                    </div>
                </div>
            </div>
        </div>

        <button onclick="run()" class="w-full bg-green-500 text-black font-black py-4 rounded-2xl mt-8 text-sm uppercase tracking-widest active:scale-95 transition-all shadow-lg shadow-green-500/20">HESAPLA</button>
    </div>

    <div id="latestCard"></div>
    <div id="archiveContainer" class="hidden mt-6 space-y-3">
        <h2 class="text-[10px] font-black text-zinc-600 uppercase tracking-[0.2em] mb-4">Ge√ßmi≈ü Analizler</h2>
        <div id="arcList"></div>
    </div>

    <script>
        const CONFIG = {
            PL: { res: 1.00, ppa_b: 22, sca_b: 45, xg_b: 0.12 },
            LL: { res: 0.85, ppa_b: 18, sca_b: 38, xg_b: 0.10 },
            SA: { res: 0.90, ppa_b: 19, sca_b: 40, xg_b: 0.11 },
            BL: { res: 1.15, ppa_b: 26, sca_b: 52, xg_b: 0.14 },
            L1: { res: 1.00, ppa_b: 20, sca_b: 42, xg_b: 0.12 }
        };

        let cL = 'PL';
        function sL(l){ cL=l; document.querySelectorAll('.btn-lig').forEach(b=>b.classList.remove('active')); document.getElementById('l-'+l).classList.add('active'); }
        function toggleArchive() { document.getElementById('archiveContainer').classList.toggle('hidden'); }

        function run() {
            const getV = (id) => Number(document.getElementById(id).value);
            const ids = ["h_xg","a_xg","h_ppa","a_ppa","h_pr","a_pr","h_sca","a_sca"];
            if (ids.some(id => document.getElementById(id).value === "")) { alert("Eksik veri!"); return; }

            const l = CONFIG[cL];
            const avgXG = (getV("h_xg") + getV("a_xg")) / 2;
            const tPPA = getV("h_ppa") + getV("a_ppa");
            const tSCA = getV("h_sca") + getV("a_sca");
            const tPR = getV("h_pr") + getV("a_pr");
            const ratio = tPR / (tPPA || 1);
            
            const xgP = (avgXG / l.xg_b) * 45;
            const ppaP = ((tPPA / l.ppa_b) * l.res) * 40;
            const scaP = ((tSCA / l.sca_b) * l.res) * 15;

            let effMod = 4.5 / (ratio || 1);
            effMod = Math.min(1.25, Math.max(0.75, effMod));

            const finalScore = (xgP + ppaP + scaP) * effMod;

            const c = [
                Math.round(Math.max(0, 100 - Math.abs(finalScore - 48) * 4)),
                Math.round(Math.max(0, 100 - Math.abs(finalScore - 75) * 4)),
                Math.round(Math.max(0, 100 - Math.abs(finalScore - 105) * 4))
            ];

            const item = { 
                h: document.getElementById('hN').value||"EV", a: document.getElementById('aN').value||"DEP", 
                c, id: Date.now(), l: cL, res: null, r: ratio.toFixed(1)
            };

            let db = JSON.parse(localStorage.getItem('fuel_mobi_db') || '[]');
            db.push(item);
            localStorage.setItem('fuel_mobi_db', JSON.stringify(db));
            
            ids.forEach(id => document.getElementById(id).value = "");
            document.getElementById('hN').value = ""; document.getElementById('aN').value = "";
            render();
        }

        function render() {
            const db = JSON.parse(localStorage.getItem('fuel_mobi_db') || '[]');
            const arcList = document.getElementById('arcList');
            const latest = document.getElementById('latestCard');
            arcList.innerHTML = ""; latest.innerHTML = "";
            let w = 0, l = 0;

            db.forEach((i, idx) => {
                if(i.res === 'W') w++; if(i.res === 'L') l++;
                const bC = i.res === 'W' ? 'win-border' : (i.res === 'L' ? 'loss-border' : '');
                
                const html = `<div class="mini-card relative ${bC}">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <span class="text-[8px] font-black text-zinc-600 uppercase tracking-widest">${i.l} | R: ${i.r}</span>
                            <h3 class="text-xs font-black text-zinc-100 uppercase mt-0.5">${i.h} - ${i.a}</h3>
                        </div>
                        <div class="flex gap-1">
                            <button onclick="setR('${i.id}','W')" class="w-8 h-8 rounded-lg text-[10px] font-black ${i.res==='W'?'bg-green-500 text-black':'bg-zinc-800 text-green-500'}">W</button>
                            <button onclick="setR('${i.id}','L')" class="w-8 h-8 rounded-lg text-[10px] font-black ${i.res==='L'?'bg-red-500 text-black':'bg-zinc-800 text-red-500'}">L</button>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        ${box("2 GOL", i.c[0], "#22c55e")}
                        ${box("3 GOL", i.c[1], "#3b82f6")}
                        ${box("3.5 √úST", i.c[2], "#ef4444")}
                    </div>
                    <button onclick="rm('${i.id}')" class="absolute -bottom-1 -right-1 p-3 text-[10px] text-zinc-800 font-black">Sƒ∞L</button>
                </div>`;
                
                if(idx === db.length - 1) latest.innerHTML = `<p class="text-[9px] font-black text-green-500 mb-2 uppercase tracking-widest text-center">Analiz Sonucu</p>` + html;
                const div = document.createElement('div'); div.innerHTML = html; arcList.prepend(div);
            });
            
            document.getElementById('wr').innerText = (w+l) > 0 ? Math.round((w/(w+l))*100) + "%" : "0%";
        }

        function box(l, v, c) {
            const secure = v >= 78;
            return `<div class="flex flex-col items-center justify-center py-3 rounded-xl ${secure?'bg-green-500/5 border border-green-500/20':'bg-zinc-900/50 border border-transparent'}">
                <span class="text-[7px] font-black text-zinc-500 mb-1 tracking-tighter">${l}</span>
                <span class="text-lg font-black" style="color:${secure?c:(v>=60?'#fff':'#3f3f46')}">${v}%</span>
                ${secure?'<div class="w-1 h-1 bg-green-500 rounded-full mt-1 animate-ping"></div>':''}
            </div>`;
        }

        function setR(id, r) {
            let db = JSON.parse(localStorage.getItem('fuel_mobi_db') || '[]');
            db = db.map(i => i.id == id ? {...i, res: i.res === r ? null : r} : i);
            localStorage.setItem('fuel_mobi_db', JSON.stringify(db));
            render();
        }

        function rm(id) { if(confirm("Sil?")) { let db = JSON.parse(localStorage.getItem('fuel_mobi_db') || '[]'); db = db.filter(i => i.id != id); localStorage.setItem('fuel_mobi_db', JSON.stringify(db)); render(); } }
        function clrAll() { if(confirm("Temizle?")) { localStorage.removeItem('fuel_mobi_db'); render(); } }
        window.onload = render;
    </script>
</body>
</html>

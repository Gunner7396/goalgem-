import pandas as pd

# Ã–rnek Veri Seti (GerÃ§ekte bu verileri bot otomatik Ã§ekecek)
data = {
    'TakÄ±m': ['Liverpool', 'Man City', 'Arsenal', 'Chelsea', 'Tottenham'],
    'npxG_Son5': [12.5, 11.2, 8.4, 9.1, 7.5],  # Pozisyon kalitesi toplamÄ±
    'AtÄ±lan_Gol': [4, 12, 8, 9, 6],           # GerÃ§ekte tabelaya yansÄ±yan
    'Saha_BaskÄ±sÄ±': [68, 62, 58, 55, 52]      # Field Tilt %
}

df = pd.DataFrame(data)

def anomali_tespit_et(row):
    # npxG ile AtÄ±lan Gol farkÄ± (G-xG)
    verimlilik = row['AtÄ±lan_Gol'] - row['npxG_Son5']
    
    # EÄER TAKIM Ã‡OK POZÄ°SYONA GÄ°RÄ°P (xG yÃ¼ksek) GOL ATAMIYORSA (G dÃ¼ÅŸÃ¼k)
    if verimlilik < -3.0 and row['Saha_BaskÄ±sÄ±'] > 60:
        return "ğŸš€ KRÄ°TÄ°K ANOMALÄ°: Gol PatlamasÄ± Bekleniyor (ÅanssÄ±z TakÄ±m)"
    
    # EÄER TAKIM POZÄ°SYON BULAMADAN (xG dÃ¼ÅŸÃ¼k) Ã‡OK GOL ATMIÅSA
    elif verimlilik > 3.0:
        return "âš ï¸ RÄ°SK: Åans FaktÃ¶rÃ¼ YÃ¼ksek (Gerileme Bekleniyor)"
    
    return "âœ… Stabil: Veriler normal."

# Analizi Ã‡alÄ±ÅŸtÄ±r
df['Analiz_Notu'] = df.apply(anomali_tespit_et, axis=1)

# Sadece "deÄŸerli" olanlarÄ± gÃ¶ster
anomaliler = df[df['Analiz_Notu'] != "âœ… Stabil: Veriler normal."]
print(anomaliler[['TakÄ±m', 'Analiz_Notu']])

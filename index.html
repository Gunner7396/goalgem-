import pandas as pd
from scipy.stats import poisson

# --- AYAR ---
# GitHub'daki dosyanÄ±n 'RAW' linkini buraya yapÄ±ÅŸtÄ±r
GITHUB_URL = "BURAYA_RAW_LINKI_GELECEK"

def github_analiz_motoru(ev_adi, dep_adi):
    try:
        # Veriyi GitHub'dan Ã§ek
        df = pd.read_csv(GITHUB_URL)
        
        # TakÄ±mlarÄ± ayÄ±kla
        ev = df[df['Takim'] == ev_adi].iloc[0]
        dep = df[df['Takim'] == dep_adi].iloc[0]

        # 20 Metrik MantÄ±ÄŸÄ±yla GÃ¼Ã§ Hesaplama (Ã–rnek Parametreler)
        # npxG ve SCA gibi metrikleri aÄŸÄ±rlÄ±klandÄ±rarak Lambda (Gol Beklentisi) oluÅŸturma
        l_ev = (ev['npxG'] * 0.7 + ev['SCA'] * 0.02) * 1.2  # Ev sahibi bonusu
        l_dep = (dep['npxG'] * 0.7 + dep['SCA'] * 0.02) * 0.8 # Deplasman Ã§arpanÄ±

        # Poisson OlasÄ±lÄ±klarÄ±
        def hesapla(l1, l2):
            prob_alt = sum([poisson.pmf(i, l1 + l2) for i in range(3)])
            prob_kg = (1 - poisson.pmf(0, l1)) * (1 - poisson.pmf(0, l2))
            return (1 - prob_alt) * 100, prob_kg * 100

        ust, kg = hesapla(l_ev, l_dep)

        # --- SONUÃ‡ ---
        print(f"\nğŸš€ {ev_adi.upper()} vs {dep_adi.upper()} ANALÄ°ZÄ°")
        print("-" * 30)
        print(f"ğŸ”¹ 2.5 ÃœST Ä°HTÄ°MALÄ°:  %{ust:.1f}")
        print(f"ğŸ”¹ KG VAR Ä°HTÄ°MALÄ°:   %{kg:.1f}")
        print("-" * 30)
        print("âœ… Analiz manuel verilerinizle GitHub Ã¼zerinden yapÄ±ldÄ±.")

    except Exception as e:
        print(f"âŒ Hata: Veri okunamadÄ± veya takÄ±m bulunamadÄ±. ({e})")

# Ã‡ALIÅTIR
github_analiz_motoru("Galatasaray", "Fenerbahce")

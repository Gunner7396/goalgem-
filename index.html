<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analiz Motoru - Olasılık v4.0</title>
    <style>
        :root { --accent: #00ff88; --bg: #0b0f1a; --card: #161e2d; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: #f3f4f6; margin: 0; padding: 10px; font-size: 13px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .card { background: var(--card); padding: 10px; border-radius: 12px; border: 1px solid #1f2937; }
        h4 { text-align: center; margin: 0 0 10px 0; color: var(--accent); font-size: 11px; text-transform: uppercase; }
        label { display: block; font-size: 9px; color: #9ca3af; margin-top: 4px; }
        input { width: 100%; background: #000; border: 1px solid #374151; color: #fff; padding: 6px; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: var(--accent); border: none; border-radius: 10px; color: #000; font-weight: 800; margin-top: 10px; cursor: pointer; }
        
        #sonuc { margin-top: 15px; display: none; }
        .skor-box { background: #1f2937; padding: 15px; border-radius: 15px; text-align: center; border: 1px solid var(--accent); }
        .skor { font-size: 36px; font-weight: 900; color: #fff; margin-bottom: 10px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-top: 10px; }
        .stat-item { background: rgba(0,0,0,0.3); padding: 8px; border-radius: 6px; font-size: 11px; }
        .stat-val { display: block; font-weight: bold; color: var(--accent); font-size: 14px; }
    </style>
</head>
<body>

<div class="grid">
    <div class="card">
        <h4>EV SAHİBİ</h4>
        <label>npxG / SCA</label>
        <div style="display:flex; gap:2px"><input type="number" id="e_npxg" value="1.6"><input type="number" id="e_sca" value="22"></div>
        <label>BOX / Tilt%</label>
        <div style="display:flex; gap:2px"><input type="number" id="e_box" value="28"><input type="number" id="e_tilt" value="55"></div>
        <label>ProgP / npxGA</label>
        <div style="display:flex; gap:2px"><input type="number" id="e_progp" value="45"><input type="number" id="e_npxga" value="1.0"></div>
        <label>PPDA / OPP.B</label>
        <div style="display:flex; gap:2px"><input type="number" id="e_ppda" value="9"><input type="number" id="e_oppb" value="12"></div>
        <label>DeepA / Inter.</label>
        <div style="display:flex; gap:2px"><input type="number" id="e_deepa" value="4"><input type="number" id="e_inter" value="10"></div>
    </div>

    <div class="card">
        <h4>DEPLASMAN</h4>
        <label>npxG / SCA</label>
        <div style="display:flex; gap:2px"><input type="number" id="d_npxg" value="1.2"><input type="number" id="d_sca" value="16"></div>
        <label>BOX / Tilt%</label>
        <div style="display:flex; gap:2px"><input type="number" id="d_box" value="20"><input type="number" id="d_tilt" value="45"></div>
        <label>ProgP / npxGA</label>
        <div style="display:flex; gap:2px"><input type="number" id="d_progp" value="32"><input type="number" id="d_npxga" value="1.4"></div>
        <label>PPDA / OPP.B</label>
        <div style="display:flex; gap:2px"><input type="number" id="d_ppda" value="14"><input type="number" id="d_oppb" value="19"></div>
        <label>DeepA / Inter.</label>
        <div style="display:flex; gap:2px"><input type="number" id="d_deepa" value="8"><input type="number" id="d_inter" value="16"></div>
    </div>
</div>

<button onclick="superAnaliz()">DERİNLEMESİNE ANALİZ ET</button>

<div id="sonuc">
    <div class="skor-box">
        <div style="font-size:10px; color:#9ca3af">TAHMİNİ SKOR</div>
        <div class="skor" id="skorOut">0 - 0</div>
        
        <div class="stats-grid">
            <div class="stat-item">2.5 ÜST <span class="stat-val" id="ustOut">%0</span></div>
            <div class="stat-item">KG VAR <span class="stat-val" id="kgvOut">%0</span></div>
            <div class="stat-item">1/X/2 <span class="stat-val" id="tarafOut">-%</span></div>
            <div class="stat-item">GÜVEN <span class="stat-val" id="guvenOut">%0</span></div>
        </div>
    </div>
</div>

<script>
function superAnaliz() {
    const v = (id) => parseFloat(document.getElementById(id).value);

    function beklentiHesapla(p, r) {
        let h = (v(p+'npxg') * 0.45) + (v(p+'box') * 0.03) + (v(p+'sca') * 0.02);
        let s = (v(r+'npxga') * 0.40) + (v(r+'oppb') * 0.03) + (v(r+'deepa') * 0.02);
        
        // Interception & Tilt Dengelemesi
        if (v(r+'tilt') > 55) s *= 0.85; // Topa sahip olanın interception ihtiyacı azalır

        let xG = (h * 0.6) + (s * 0.4);
        // Absürt Skor Törpüsü
        if (xG > 2.2) xG = 2.2 + Math.log10(xG - 1.2);
        return xG;
    }

    let e_exp = beklentiHesapla('e_', 'd_') * 1.05; // Ev avantajı
    let d_exp = beklentiHesapla('d_', 'e_');

    // Olasılık Hesaplama (Basitleştirilmiş Poisson Yaklaşımı)
    let kgVarOlasilik = Math.min(95, (1 - Math.exp(-e_exp)) * (1 - Math.exp(-d_exp)) * 130);
    let ustOlasilik = Math.min(95, (1 - Math.exp(-(e_exp + d_exp) * 0.6)) * 110);
    
    // Taraf Yüzdesi
    let toplam = e_exp + d_exp;
    let evYuzde = (e_exp / toplam) * 100;
    let taraf = evYuzde > 55 ? "1 (%"+evYuzde.toFixed(0)+")" : (evYuzde < 45 ? "2 (%"+(100-evYuzde).toFixed(0)+")" : "X");

    // Güven Endeksi (Veri tutarlılığına göre)
    let guven = 100 - (Math.abs(v('e_npxg') - v('e_npxga')) * 10);

    // Çıktılar
    document.getElementById('sonuc').style.display = 'block';
    document.getElementById('skorOut').innerText = e_exp.toFixed(1) + " - " + d_exp.toFixed(1);
    document.getElementById('kgvOut').innerText = "%" + kgVarOlasilik.toFixed(0);
    document.getElementById('ustOut').innerText = "%" + ustOlasilik.toFixed(0);
    document.getElementById('tarafOut').innerText = taraf;
    document.getElementById('guvenOut').innerText = "%" + Math.max(30, Math.min(95, guven)).toFixed(0);
}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Serie A Akıllı Analiz</title>
    <style>
        :root {
            --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --text: #f1f5f9;
            --win: #22c55e; --loss: #ef4444; --warning: #f59e0b;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 12px; }
        .dashboard { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); padding: 20px; border-radius: 15px; border: 1px solid #334155; margin-bottom: 20px; }
        .stats-row { display: flex; justify-content: space-around; text-align: center; }
        .stat-val { display: block; font-size: 1.8rem; font-weight: 800; color: var(--accent); }
        .stat-label { font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        
        .alert-box { display: none; margin-top: 15px; padding: 10px; border-radius: 8px; font-size: 0.85rem; line-height: 1.4; background: rgba(245, 158, 11, 0.1); border: 1px solid var(--warning); color: var(--warning); }

        .input-card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 12px; }
        .team-title { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--accent); color: #000; font-weight: bold; margin-bottom: 15px; font-size: 1rem; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        input[type="number"] { background: #334155; border: 1px solid #475569; color: white; padding: 12px; border-radius: 8px; font-size: 1rem; -moz-appearance: textfield; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; }

        .btn-group { display: grid; grid-template-columns: 1fr 2fr; gap: 10px; margin: 20px 0; }
        button { border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-clear { background: #475569; color: white; padding: 15px; }
        .btn-main { background: var(--win); color: white; font-size: 1.1rem; }
        
        .card { background: var(--card); margin-bottom: 10px; padding: 15px; border-radius: 12px; border-left: 5px solid var(--accent); animation: fadeIn 0.4s ease; }
        .card.win { border-color: var(--win); }
        .card.loss { border-color: var(--loss); }
        .status-badge { font-size: 0.7rem; padding: 3px 8px; border-radius: 4px; float: right; text-transform: uppercase; }
        
        .outcome-btns { display: flex; gap: 10px; margin-top: 12px; }
        .outcome-btns button { flex: 1; padding: 8px; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div class="dashboard">
        <div class="stats-row">
            <div><span class="stat-val" id="totalCount">0</span><span class="stat-label">Analiz</span></div>
            <div><span class="stat-val" id="rateVal">%0</span><span class="stat-label">Başarı</span></div>
        </div>
        <div id="aiAlert" class="alert-box">
            <strong>⚠️ PERFORMANS UYARISI:</strong> Başarı oranı %80'in altına düştü. Model, <b>npxG/S</b> verisindeki sapmaları hafife alıyor olabilir. Savunma <b>Blocks</b> verilerini daha ağır puanlaman önerilir.
        </div>
    </div>

    <div id="form">
        <div class="input-card">
            <input type="text" id="tA" class="team-title" placeholder="EV SAHİBİ">
            <div class="grid" id="gA"></div>
        </div>
        <div class="input-card">
            <input type="text" id="tB" class="team-title" placeholder="DEPLASMAN">
            <div class="grid" id="gB"></div>
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-clear" onclick="clearInp()">SİL</button>
        <button class="btn-main" onclick="run()">ANALİZ ET</button>
    </div>

    <h3 style="margin-left:5px;">Geçmiş Tahminler</h3>
    <div id="history"></div>

<script>
    const fields = ["Dist", "CPA", "PrgP", "SCA", "Poss 3rd", "npxG/S", "Blocks", "Interc", "Recovery", "Err"];
    let data = JSON.parse(localStorage.getItem('sa_v2_data')) || [];
    let stats = JSON.parse(localStorage.getItem('sa_v2_stats')) || { t: 0, w: 0 };

    function init() {
        ['A', 'B'].forEach(team => {
            const div = document.getElementById('g' + team);
            fields.forEach(f => {
                div.innerHTML += `<input type="number" id="${f}_${team}" step="any" inputmode="decimal" placeholder="${f}">`;
            });
        });
        updateUI();
    }

    function run() {
        const nameA = document.getElementById('tA').value || "Takım A";
        const nameB = document.getElementById('tB').value || "Takım B";
        const scaA = parseFloat(document.getElementById('SCA_A').value) || 0;
        const scaB = parseFloat(document.getElementById('SCA_B').value) || 0;
        const errB = parseFloat(document.getElementById('Err_B').value) || 0;

        let prob = Math.min(98, 25 + (scaA * 0.7) + (errB * 15));
        let pred = prob > 60 ? "2.5 ÜST / KG VAR" : "2.5 ALT / KG YOK";

        const obj = { id: Date.now(), teams: nameA + " vs " + nameB, pred: pred, prob: prob.toFixed(0), status: 'p' };
        data.unshift(obj);
        save();
        updateUI();
    }

    function mark(id, s) {
        const item = data.find(x => x.id === id);
        if(item && item.status === 'p') {
            item.status = s;
            stats.t++;
            if(s === 'w') stats.w++;
            save();
            updateUI();
        }
    }

    function updateUI() {
        document.getElementById('totalCount').innerText = stats.t;
        const rate = stats.t === 0 ? 0 : Math.round((stats.w / stats.t) * 100);
        document.getElementById('rateVal').innerText = `%${rate}`;
        
        // Başarı Oranı Denetimi
        const alertBox = document.getElementById('aiAlert');
        if(stats.t > 5 && rate < 80) {
            alertBox.style.display = 'block';
        } else {
            alertBox.style.display = 'none';
        }

        const hist = document.getElementById('history');
        hist.innerHTML = '';
        data.forEach(x => {
            hist.innerHTML += `
                <div class="card ${x.status === 'w' ? 'win' : x.status === 'l' ? 'loss' : ''}">
                    <div style="font-weight:bold">${x.teams} 
                        <span class="status-badge" style="background:${x.status === 'w' ? 'var(--win)' : x.status === 'l' ? 'var(--loss)' : 'var(--accent)'}">${x.status === 'p' ? 'Bekliyor' : x.status === 'w' ? 'Tuttu' : 'Yattı'}</span>
                    </div>
                    <div style="font-size:0.85rem; margin-top:5px;">Tahmin: ${x.pred} (%${x.prob})</div>
                    ${x.status === 'p' ? `
                    <div class="outcome-btns">
                        <button style="background:var(--win); color:white;" onclick="mark(${x.id}, 'w')">TUTTU</button>
                        <button style="background:var(--loss); color:white;" onclick="mark(${x.id}, 'l')">YATMADI</button>
                    </div>` : ''}
                </div>`;
        });
    }

    function clearInp() { document.querySelectorAll('input').forEach(i => i.value = ''); }
    function save() {
        localStorage.setItem('sa_v2_data', JSON.stringify(data));
        localStorage.setItem('sa_v2_stats', JSON.stringify(stats));
    }
    init();
</script>
</body>
</html>
